@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================
   Pixel Art Theme for Polydraft
   ============================================ */

:root {
  /* Base colors - always dark theme */
  --background: #1a1a2e;
  --foreground: #f1f5f9;

  /* Game colors */
  --game-bg: #1a1a2e;
  --game-primary: #16213e;
  --game-secondary: #0f3460;
  --game-accent: #e94560;
  --game-gold: #ffd700;
  --game-success: #4ade80;
  --game-failure: #6b7280;

  /* Pixel size base */
  --pixel-size: 4px;
}

/* Force dark theme always */
@media (prefers-color-scheme: light) {
  :root {
    --background: #1a1a2e;
    --foreground: #f1f5f9;
  }
}

/* ============================================
   Base Styles
   ============================================ */

html {
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  color: var(--foreground);
  background: var(--background);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  min-height: 100vh;
  min-height: 100dvh;
  overflow-x: hidden;
}

/* ============================================
   Pixel Art Rendering
   ============================================ */

.pixel-art,
.pixel-sprite,
canvas {
  image-rendering: -moz-crisp-edges;
  image-rendering: -webkit-crisp-edges;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
}

/* ============================================
   Utility Classes
   ============================================ */

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }

  /* Pixel-perfect borders */
  .border-pixel {
    border-width: 2px;
    border-style: solid;
  }

  /* Retro text shadow */
  .text-shadow-pixel {
    text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.5);
  }

  /* Glass morphism for cards */
  .glass {
    background: rgba(30, 41, 59, 0.8);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
  }

  /* Hide scrollbar but allow scrolling */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Preserve 3D for card flips */
  .preserve-3d {
    transform-style: preserve-3d;
  }

  .backface-hidden {
    backface-visibility: hidden;
  }

  .perspective-1000 {
    perspective: 1000px;
  }

  .rotate-y-180 {
    transform: rotateY(180deg);
  }

  /* Gradient text */
  .text-gradient-gold {
    background: linear-gradient(135deg, #ffd700 0%, #ffaa00 50%, #ffd700 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
}

/* ============================================
   Component Base Styles
   ============================================ */

@layer components {
  /* Pixel button base */
  .btn-pixel {
    @apply relative px-6 py-3 font-bold uppercase tracking-wider;
    @apply bg-game-accent text-white;
    @apply border-2 border-black;
    @apply shadow-pixel active:shadow-none active:translate-x-1 active:translate-y-1;
    @apply transition-all duration-100;
    @apply hover:brightness-110;
  }

  .btn-pixel-secondary {
    @apply btn-pixel bg-game-secondary;
  }

  .btn-pixel-gold {
    @apply btn-pixel bg-game-gold text-black;
  }

  /* Card base */
  .card-pixel {
    @apply relative p-4;
    @apply bg-card-bg border-2 border-card-border;
    @apply shadow-pixel;
  }

  /* Glowing effect */
  .glow-gold {
    animation: glow-pulse 2s ease-in-out infinite;
  }

  @keyframes glow-pulse {
    0%,
    100% {
      box-shadow: 0 0 5px var(--game-gold), 0 0 10px var(--game-gold);
    }
    50% {
      box-shadow: 0 0 20px var(--game-gold), 0 0 30px var(--game-gold);
    }
  }

  /* Pack sprite placeholder */
  .pack-sprite {
    @apply relative w-32 h-44 bg-game-primary border-4 border-game-accent;
    @apply flex items-center justify-center;
    @apply shadow-pixel-lg;
    background: linear-gradient(
      135deg,
      var(--game-primary) 0%,
      var(--game-secondary) 50%,
      var(--game-primary) 100%
    );
  }

  /* Event card placeholder */
  .event-card {
    @apply relative w-full aspect-[3/4] bg-card-bg border-2 border-card-border;
    @apply flex flex-col items-center justify-between p-4;
    @apply shadow-pixel;
  }

  /* Probability badge */
  .prob-badge {
    @apply inline-flex items-center px-2 py-1;
    @apply text-xs font-bold;
    @apply border border-current rounded-sm;
  }

  /* Status indicator */
  .status-dot {
    @apply w-2 h-2 rounded-full;
  }

  .status-pending {
    @apply status-dot bg-yellow-500 animate-pulse;
  }

  .status-resolved {
    @apply status-dot bg-green-500;
  }

  .status-win {
    @apply status-dot bg-game-success;
  }

  .status-lose {
    @apply status-dot bg-game-failure;
  }
}

/* ============================================
   CRT Scanline Effect (optional)
   ============================================ */

.crt-effect::after {
  content: "";
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0, 0, 0, 0.1) 2px,
    rgba(0, 0, 0, 0.1) 4px
  );
  pointer-events: none;
  z-index: 100;
}

/* ============================================
   Safe Area for Mobile
   ============================================ */

.safe-area-inset-bottom {
  padding-bottom: env(safe-area-inset-bottom, 0);
}

.safe-area-inset-top {
  padding-top: env(safe-area-inset-top, 0);
}

/* ============================================
   Selection Color
   ============================================ */

::selection {
  background: var(--game-accent);
  color: white;
}

::-moz-selection {
  background: var(--game-accent);
  color: white;
}

/* ============================================
   Balatro Post-Processing Effects
   ============================================ */

/* Noise overlay */
.balatro-noise::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  opacity: 0.05;
  pointer-events: none;
  z-index: 9998;
  mix-blend-mode: overlay;
}

/* Vignette */
.balatro-vignette::after {
  content: '';
  position: fixed;
  inset: 0;
  background: radial-gradient(ellipse at center, transparent 50%, rgba(0,0,0,0.4) 100%);
  pointer-events: none;
  z-index: 9997;
}

/* Scanlines sutiles */
.balatro-scanlines {
  position: relative;
}

.balatro-scanlines > *:first-child::before {
  content: '';
  position: fixed;
  inset: 0;
  background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.03) 2px, rgba(0,0,0,0.03) 4px);
  pointer-events: none;
  z-index: 9996;
}

/* ============================================
   Balatro Card Styles
   ============================================ */

/* Card base Balatro */
.balatro-card {
  @apply relative border-balatro border-white/20 rounded-balatro-card;
  box-shadow: 4px 4px 0 0 rgba(0, 0, 0, 0.8);
  transition: transform 0.15s ease-out, box-shadow 0.15s ease-out;
}

.balatro-card:hover {
  transform: translateY(-4px) rotate(-1deg);
  box-shadow: 6px 8px 0 0 rgba(0, 0, 0, 0.6);
}

/* Inner border (signature Balatro) */
.balatro-card-inner {
  @apply absolute inset-[4px] border-2 border-white/20 rounded-[12px] pointer-events-none;
  box-shadow: inset 0 0 10px rgba(255,255,255,0.05);
}

/* Foil shimmer for rare cards */
.balatro-foil {
  background: linear-gradient(135deg, transparent 0%, rgba(255,255,255,0.15) 25%, rgba(255,255,255,0.4) 50%, rgba(255,255,255,0.15) 75%, transparent 100%);
  background-size: 200% 200%;
  animation: foil-shimmer 2s linear infinite;
}

@keyframes foil-shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

/* Holo effect for legendary */
.balatro-holo {
  background: linear-gradient(135deg, rgba(255,0,0,0.2), rgba(255,165,0,0.2), rgba(255,255,0,0.2), rgba(0,255,0,0.2), rgba(0,0,255,0.2), rgba(255,0,255,0.2));
  background-size: 400% 400%;
  animation: foil-shimmer 3s linear infinite;
}

/* Screen shake utility */
.shake-screen {
  animation: screen-shake 0.4s ease-in-out;
}

@keyframes screen-shake {
  0%, 100% { transform: translate(0); }
  25% { transform: translate(-4px, 2px); }
  50% { transform: translate(4px, -2px); }
  75% { transform: translate(-2px, 0); }
}

/* Text shadow Balatro style */
.text-shadow-balatro {
  text-shadow: 2px 2px 0 rgba(0,0,0,0.8), 4px 4px 0 rgba(0,0,0,0.4);
}
